---
apiVersion: v1
kind: Pod
metadata:
  name: umami
  labels:
    app: umami
  annotations:
    kraud.cloud/mem:      "8G"
    kraud.cloud/epc:      "256M"
    kraud.cloud/segment:  "hma"
spec:
  containers:
    - name:  db
      image: ghcr.io/edgelesssys/edgelessdb-sgx-1gb
      env:
        - name:  OE_SIMULATION
          value: "1"

    - name: umami
      image: enclaive/umami-sgx
---
apiVersion: v1
kind: Service
metadata:
  name: umami
spec:
  selector:
    app: umami
  ports:
    - protocol:   tcp
      port:       80
      targetPort: 3000
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: wordpress
spec:
  rules:
  - host: wordpress.enclaive.io
    http:
      paths:
      - pathType: Prefix
        path: "/"
        backend:
          service:
            name: "umami"
            port:
              number: 80
